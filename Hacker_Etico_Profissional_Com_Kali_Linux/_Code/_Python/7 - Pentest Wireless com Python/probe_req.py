#!/usr/bin/env python
# -*- coding: UTF-8 -*-

"""
  Esse arquivo tenta 
  fazer a localização
  de clientes conectados
  aos pontos de acessos
  wifi com o Dot11ProbeReq

  Modificado em 20 de dezembro de 2016
  por Vitor Mazuco (vitor.mazuco@gmail.com)
"""

# Importação das bibliotecas necessárias
from scapy.all import *

interface ='wlan0mon' # Tipo de interface de rede
probe_req = []
ap_name = raw_input("Coloque o nome do roteador ")

def probesniff(fm):
	if fm.haslayer(Dot11ProbeReq):
		client_name = fm.info
		if client_name == ap_name :
			if fm.addr2 not in probe_req:
				print "Novo pedido de sonda: ", client_name 
				print "MAC ", fm.addr2
				probe_req.append(fm.addr2)
			
sniff(iface= interface,prn=probesniff)










