#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# 1 - dns.py3

"""
  Esse arquivo faz a enumeração
  dos servidores DNS 

  Modificado em 31 de outubro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""

import socket
dominio = "dominio.com" 
nomes = ["ns1", "ns2", "www", "ftp", "intranet"]  

# Temos um loop que informa quais são os domínios de DNS daquele alvo
for nome in nomes:
    DNS = nome + "." + dominio  # Escolha o domínio que deseja, gerando os nomes DNS
    try:
        print(DNS + ": " + socket.gethostbyname(DNS)) # Faz a concatenação dos nomes. Ele usa o comando "socket.gethostbyname" para ver o DNS partindo de um IP, caso contrário será gerado um erro
    except socket.gaierror: 
        pass




