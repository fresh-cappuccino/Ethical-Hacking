#!/usr/bin/env python
# -*- coding: UTF-8 -*-
# 5-dns-enum.py - SLIDES

"""

  Esse arquivo faz a enumeração dos registros
  do DNS

  Modificado em 01 de novembro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""

import dns.resolver

dominio = "teste.com.br"
registros = ["A", "AAAA", "MX", "NS"] #1 Quais registros serão testados.

#2 Loop de testes
for registro in registros:
    resposta = dns.resolver.query(dominio, registro, raise_on_no_answer=False) #3 Checa se realmente existe esse domínio ou não nos endereços pesquisados.
    if resposta.rrset is not None:
        print resposta.rrset







