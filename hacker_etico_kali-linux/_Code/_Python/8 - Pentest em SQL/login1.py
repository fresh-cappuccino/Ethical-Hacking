#!/usr/bin/env python
# -*- coding: UTF-8 -*-

"""
  Esse arquivo tenta
  fazer a garimpagem 
  de links URL que contenha 
  páginas de SQL Injetion
  por uma worldlist

  Modificado em 21 de dezembro de 2016
  por Vitor Mazuco (vitor.mazuco@gmail.com)
"""

# Importação das bibliotecas necessárias
import httplib
import shelve


url = raw_input("Coloque a URL completa do alvo: ")
url1 =url.replace("http://","")
url2= url1.replace("/","")
s = shelve.open("vitor.mazuco",writeback=True)

for u in s['php']:
	a = "/"
	url_n = url2+a+u
	print url_n
	http_r = httplib.HTTPConnection(url2)
	u=a+u
	http_r.request("GET",u)
	reply = http_r.getresponse()
	
	if reply.status == 200:
		print "\n URL encontrado ---- ", url_n
		ch = raw_input("Pressione 'c' para continuar : ")
		if ch == "c" or ch == "C" :
			continue 
		else :
			break
	
s.close()
